(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{105:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var r=a(0),n=a.n(r),s=a(3),c=a.n(s),o=a(1);const l=({curr:e,prev:t})=>{const a=t>-1?parseInt(e-t,10):-1;if(a<0)return null;const r=(e=>{let t=parseInt(e/1e3,10);const a=parseInt(t/3600,10);t%=3600;const r=parseInt(t/60,10);return[a,r,t%=60,e-=1e3*(3600*a+60*r+t)]})(a);return n.a.createElement("div",{style:{position:"absolute",left:"50%",top:"-9px"}},n.a.createElement(o.Label,{size:"tiny",color:r[2]?"warning":r[0]||r[1]?"danger":"info",style:{position:"absolute",left:"-50%",whiteSpace:"nowrap"},raised:!0},"+ ",r[0]?`${r[0]} h `:"",r[1]?`${r[1]} m `:"",r[2]?`${r[2]} s `:"",r[3]?`${r[3]} ms`:"0 ms"))};l.propTypes={curr:c.a.number.isRequired,prev:c.a.number.isRequired}},106:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));const r={scheme:"monokai",author:"Vitaly Kumov based on Cisco UI kit",base00:"#ffffff",base01:"#f2f2f2",base02:"#64bbe3",base03:"#b6b9bb",base04:"#39393b",base05:"#58585b",base06:"#626469",base07:"#ffffff",base08:"#14a792",base09:"#14a792",base0A:"#017cad",base0B:"#6cc04a",base0C:"#ffcc00",base0D:"#7f7f86",base0E:"#626469",base0F:"#626469"}},549:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(3),c=a.n(s),o=a(1),l=a(101),i=a.n(l),u=a(106),p=a(30);function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(a,!0).forEach((function(t){f(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function f(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const E=({message:{timestamp:e,topic:t,message:a}})=>{const r=n.a.useMemo(()=>/^\d+$/.test(e)?p.DateTime.fromMillis(e):p.DateTime.fromISO(e),[e]);return n.a.createElement(o.TimelineItem,{contentClassName:"flex-fill",style:{position:"relative"}},n.a.createElement("div",{style:{position:"absolute",top:"-9px"}},n.a.createElement(o.Label,{color:"info",size:"small",raised:!0},t)),n.a.createElement("div",{className:"qtr-margin-top text-small"},`at ${r.toFormat("HH:mm:ss.SSS dd/MM/yyyy")}`),n.a.createElement("div",{className:"text-monospace"},n.a.createElement(i.a,{data:{message:a},theme:d({},u.a,{base00:"var(--cui-background-inactive)"}),invertTheme:!1,hideRoot:!0,shouldExpandNode:(e,t,a)=>a<=0})))};E.propTypes={message:c.a.shape({timestamp:c.a.oneOfType([c.a.string,c.a.number]).isRequired,topic:c.a.string.isRequired,message:c.a.any.isRequired}).isRequired};const b=({messages:e})=>n.a.createElement("div",{className:"px-flow-container"},e.map((e,t)=>n.a.createElement(E,{message:e,key:t})));b.propTypes={messages:c.a.arrayOf(c.a.any).isRequired};var y=b,O=a(105);function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const v=["HTTP_REQUEST","HTTP_RESPONSE","GUEST_SUCCESS","GUEST_FAILURE","GUEST_REGISTERED"],T=({vsa:e})=>n.a.createElement("dl",{className:"dl--inline-centered"},e.Nested.map((e,t)=>n.a.createElement(n.a.Fragment,{key:t},n.a.createElement("dt",null,e.Name),n.a.createElement("dd",null,e.Value))));T.propTypes={vsa:c.a.shape({Nested:c.a.arrayOf(c.a.shape({Name:c.a.any,Value:c.a.any}))}).isRequired};const w=({attribute:e})=>n.a.createElement("tr",null,n.a.createElement("td",{style:{whiteSpace:"nowrap"}},e.name,"Vendor-Specific"===e.name?n.a.createElement(n.a.Fragment,null,n.a.createElement("br",null),e.Vendor):null),n.a.createElement("td",{style:{whiteSpace:"normal",wordBreak:"break-all"}},(e=>{switch(e.name){case"Message-Authenticator":case"CHAP-Password":return n.a.createElement("pre",null,e.value.hexEncode().join(" "));case"EAP-Message":case"MS-MPPE-Recv-Key":case"MS-MPPE-Send-Key":return n.a.createElement("pre",null,e.value.hexDump());case"Vendor-Specific":return n.a.createElement(T,{vsa:e});default:return e.value}})(e)));w.propTypes={attribute:c.a.shape({name:c.a.any,Vendor:c.a.any}).isRequired};const h=({packet:e})=>e&&e.length?n.a.createElement("table",{className:"table table--compressed table--bordered table--hover"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null,"Attribute"),n.a.createElement("th",null,"Value"))),n.a.createElement("tbody",null,e.map(e=>(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(a,!0).forEach((function(t){g(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e})({},e,{name:e.name||e.Name,value:e.value||e.Value})).map((e,t)=>n.a.createElement(w,{attribute:e,key:t})))):null;h.propTypes={packet:c.a.arrayOf(c.a.any).isRequired};const P=({type:e,code:t})=>{const{color:a,icon:r}=n.a.useMemo(()=>{if(1===e)return{color:"dark",icon:"arrow-left-tail"};switch(t){case"ACCESS_ACCEPT":case"ACCOUNTING_RESPONSE":case"GUEST_SUCCESS":case"GUEST_REGISTERED":return{color:"success",icon:"arrow-right-tail"};case"ACCESS_CHALLENGE":case"HTTP_RESPONSE":return{color:"secondary",icon:"arrow-right-tail"};case"COA_REQUEST":case"DISCONNECT_REQUEST":return{color:"secondary",icon:"arrow-right-tail"};default:return{color:"danger",icon:"error-outline"}}},[e,t]);return n.a.createElement(o.Button,{circle:!0,color:a},n.a.createElement(o.Icon,{icon:r}))};P.propTypes={type:c.a.number.isRequired,code:c.a.string.isRequired};const k=({packet:{packet_type:e,radius:t},prevTime:a})=>{const r=n.a.useMemo(()=>{if(1===e)return"-tertiary";switch(t.code){case"ACCESS_ACCEPT":case"ACCOUNTING_RESPONSE":case"COA_REQUEST":case"GUEST_SUCCESS":case"GUEST_REGISTERED":return"-success";case"ACCESS_CHALLENGE":case"HTTP_RESPONSE":return"-info";case"DISCONNECT_REQUEST":return"-warning";default:return"-danger"}},[e,t]);return n.a.createElement(o.TimelineItem,{icon:n.a.createElement(P,{code:t.code,type:e}),style:{position:"relative"},contentClassName:"flex-fill"},n.a.createElement(O.a,{curr:t.time,prev:a}),n.a.createElement("div",{className:"flex"},n.a.createElement("div",{className:"flex-fluid dbl-margin-right"},n.a.createElement("span",{className:`text-bold text${r}`},t.code),n.a.createElement("span",null,` at ${p.DateTime.fromMillis(t.time).toFormat("HH:mm:ss.SSS dd/MM/yyyy")}`)),t.server?n.a.createElement("div",null,1===e?"To: ":"From: ",t.server.address):null),n.a.createElement(o.Accordion,{toggles:!0},n.a.createElement(o.AccordionElement,{title:"Packet body"},n.a.createElement("div",{className:"responsive-table"},v.includes(t.code)?n.a.createElement("pre",{className:"half-margin-top",style:{wordBreak:"break-all"}},t.packet[0].value):n.a.createElement(h,{packet:t.packet})))))};k.propTypes={packet:c.a.shape({radius:c.a.any,packet_type:c.a.number}).isRequired,prevTime:c.a.number.isRequired};var C=k;function N(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(a,!0).forEach((function(t){A(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function A(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const _={"radius-auth":"Authentication","radius-acct":"Accounting","radius-coa":"CoA","radius-disconnect":"Disconnect",http:"HTTP","out-of-order":"Out of Order",pxgrid:"pxGrid"},D=({packets:e})=>n.a.createElement(o.Timeline,null,e.map((t,a)=>n.a.createElement(C,{packet:t,key:t.order,prevTime:a>0?e[a-1].radius.time:-1})));D.propTypes={packets:c.a.arrayOf(c.a.any).isRequired};const x=e=>R({},e,{code:e.Code||e.code,time:1e3*(e.Timestamp||e.time)}),U=({session:e})=>{const t=n.a.useMemo(()=>e&&Array.isArray(e.flows)&&e.flows.length?e.flows.map(e=>{let{type:t,packets:a}=e;return R({type:t},N(e,["type","packets"]),{},a?{packets:a.map(e=>{let{radius:t}=e;return R({},N(e,["radius"]),{radius:x("string"==typeof t?JSON.parse(t):t)})})}:{})}):null,[e]);return t?n.a.createElement(o.Tabs,{vertical:!0,defaultTab:"flow-0"},t.map((e,t)=>n.a.createElement(o.Tab,{key:t,id:`flow-${t}`,title:_[e.type]||e.type},"pxgrid"===e.type?n.a.createElement("div",{className:"timeline timeline--block"},n.a.createElement("div",{className:"timeline__list"},n.a.createElement(y,{messages:e.messages}))):n.a.createElement(D,{packets:e.packets})))):n.a.createElement(o.Alert.Warning,{title:"Flow is empty"},"No packets saved for the flow")};U.propTypes={session:c.a.shape({flows:c.a.array}).isRequired},U.defaultProps={};t.default=U}}]);